<div class="modal-body min-height-200">
  <form name="user_group_modal" novalidate="novalidate">
    <tabset>
      <button type="button" class="close" ng-click="cancel()">&times;</button>
      <tab heading="{{'组信息'|translate}}" active="info.active" select="selectTabs('info');">
        <div ng-if="info.active" class="scrollbar" style="padding:10px;">
          <div ng-if="!info.edit">
            <div class="row">
              <div class="col-sm-3 text-right" translate>组名：</div>
              <div class="col-sm-7">
                {{info.data.GroupName}}
              </div>
              <div class="col-sm-2">
                <a ng-click="changeEditModel();" translate>编辑</a>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>描述：</div>
              <div class="col-sm-7">
                {{info.data.Comments}}
              </div>
            </div>
          </div>
          <div ng-if="info.edit">
            <div class="row">
              <div class="col-sm-3 text-right" translate>名称：</div>
              <div class="col-sm-7">
                <input class="form-control" ng-required="true" placeholder="{{'请输入名称'|translate}}" ng-pattern="info.pattern.name"  ng-model="info.editData.GroupName">
              </div>
              <div class="col-sm-2">
                <a ng-click="changeEditModel();" translate>关闭编辑</a>
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>必填，可包含大小写字母、数字、'-'或中文且长度在1~64之间的字符</div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>描述：</div>
              <div class="col-sm-7">
                <textarea rows="5" style="resize: none;" ng-pattern="info.pattern.desc" class="form-control" placeholder="{{'请输入描述信息'|translate}}" ng-model="info.editData.Comments">
                </textarea>
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>长度在0~128之间的任意字符</div>
            </div>
          </div>
        </div>
      </tab>
      <tab heading="{{'用户管理'|translate}}" active="user.active" select="selectTabs('user');">
        <div ng-if="user.active">
          <carousel class="news-carousel">
            <slide active="user.hasUser.active">
              <div class="scrollbar" style="padding:10px;height:300px;overflow-y:auto;">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th width="30%" translate>用户名</th>
                      <th width="30%" translate>显示名</th>
                      <th width="25%" translate>加入时间</th>
                      <th width="15%" translate>操作</th>
                    </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="user.hasUser.loading">
                    <td colspan="5">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                          <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                          </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!user.hasUser.loading && +user.hasUser.list.length == 0">
                    <td colspan="5">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="user in user.hasUser.list">
                    <td align="left">{{user.UserName}}</td>
                    <td align="left"> {{user.DisplayName}}</td>
                    <td align="left">{{user.JoinDate|formatTime}}</td>
                    <td align="left">
                      <a ng-click="removeUserToGroups(user,$index);" translate>移出</a>
                    </td>
                  </tr>
                  </tbody>
                </table>
                </div>
            </slide>
            <slide active="user.listUser.active">
              <div class="scrollbar" scroll-load="loadMoreUsers()"
                   disable-scroll="user.listUser.loading || !user.listUser.hasMore" style="padding:10px;height:300px;overflow-y:auto;">
                <table class="table table-hover">
                  <thead>
                  <tr>
                    <th width="30%" translate>用户名</th>
                    <th width="30%" translate>显示名</th>
                    <th width="25%" translate>创建时间</th>
                    <th width="15%" translate>操作</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="user.listUser.loading">
                    <td colspan="5">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                        <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                        </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!user.listUser.loading && +user.listUser.list.length == 0">
                    <td colspan="5">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="user in user.listUser.list">
                    <td align="left">{{user.UserName}}</td>
                    <td align="left"> {{user.DisplayName}}</td>
                    <td align="left">{{user.CreateDate|formatTime}}</td>
                    <td align="left">
                      <a ng-show="!user.exist" ng-click="addUserToGroup(user);" translate>添加</a>
                      <span ng-show="user.exist" class="text-success" translate>已添加</span>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </slide>
          </carousel>
        </div>
      </tab>
      <tab heading="{{'授权策略'|translate}}" active="policies.active" select="selectTabs('policy');">
        <div ng-if="policies.active">
          <carousel class="news-carousel">
            <slide active="policies.hasPolicies.active">
              <div class="scrollbar" style="padding:10px;height:300px;overflow-y:auto;">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th width="18%" translate>策略名称</th>
                      <th width="16%" translate>策略类型</th>
                      <th width="16%" translate>默认版本</th>
                      <th width="20%" translate>描述</th>
                      <th width="20%" translate>授权时间</th>
                      <th width="10%" translate>操作</th>
                    </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="policies.hasPolicies.loading">
                    <td colspan="6">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                        <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                        </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!policies.hasPolicies.loading && +policies.hasPolicies.list.length == 0">
                    <td colspan="6" align="center">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="policy in policies.hasPolicies.list">
                    <td align="left">{{policy.PolicyName}}</td>
                    <td align="left">{{policy.PolicyType == 'Custom'?('自定义'|translate):('系统'|translate)}}</td>
                    <td align="left">{{policy.DefaultVersion}}</td>
                    <td align="left">{{policy.Description}}</td>
                    <td align="left">{{policy.AttachDate|formatTime}}</td>
                    <td>
                      <a ng-click="removePolicy(policy,$index)" translate>移除</a>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </slide>
            <slide active="policies.listPolicies.active">
              <div class="scrollbar"scroll-load="loadMorePolicies()"
                   disable-scroll="policies.listPolicies.loading || !policies.listPolicies.hasMore" style="padding:10px;height:300px;overflow-y:auto;">

                <table class="table table-hover">
                  <thead>
                  <tr>
                    <th width="20%" translate>策略名称</th>
                    <th width="30%" translate>描述</th>
                    <th width="18%" translate>引用次数</th>
                    <th width="18%">
                      <span dropdown>
                        <a data-toggle="dropdown" class="dropdown-toogle">
                          <span ng-show="policies.listPolicies.type == null" translate>全部类型</span>
                          <span ng-show="policies.listPolicies.type == 'Custom'" translate>自定义</span>
                          <span ng-show="policies.listPolicies.type == 'System'" translate>系统</span>
                          <span class="caret"></span>
                        </a>
                        <ul dropdown-menu class="dropdown-menu">
                          <li>
                            <a ng-click="changePolicyType(null)" translate>全部类型</a>
                          </li>
                          <li>
                            <a ng-click="changePolicyType('Custom')" translate>自定义</a>
                          </li>
                          <li>
                            <a ng-click="changePolicyType('System')" translate>系统</a>
                          </li>
                        </ul>
                      </span>
                    </th>
                    <th width="14%" translate>操作</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="policies.listPolicies.loading">
                    <td colspan="5">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                      <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                      </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!policies.listPolicies.loading && +policies.listPolicies.list.length == 0">
                    <td colspan="5" align="center">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="policy in policies.listPolicies.list">
                    <td align="left">{{policy.PolicyName}}</td>
                    <td align="left">{{policy.Description}}</td>
                    <td align="left">{{policy.AttachmentCount}}</td>
                    <td align="left">{{policy.PolicyType == 'Custom'?('自定义'|translate):('系统'|translate)}}</td>
                    <td align="left">
                      <a ng-show="!policy.exist" ng-click="setPolicy(policy)" translate>授权</a>
                      <span ng-show="policy.exist" class="text-success" translate>已授权</span>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </slide>
          </carousel>
        </div>
      </tab>

    </tabset>
  </form>
</div>
<div class="modal-footer">
  <button ng-if="info.active" ng-click="deleteGroup();" class="btn btn-danger pull-left" translate>删除该组</button>
  <a ng-if="user.active && user.hasUser.active" ng-disabled="user.hasUser.loading" ng-click="userModalChange();" class="btn btn-success pull-left" translate>加入用户</a>
  <a ng-if="user.active && user.listUser.active" ng-disabled="user.listUser.loading" ng-click="userModalChange();" class="btn btn-success pull-left" translate>返回用户</a>
  <a ng-if="policies.active && policies.hasPolicies.active" ng-disabled="policies.hasPolicies.loading" ng-click="policyModalChange();" class="btn btn-success pull-left" translate>添加授权</a>
  <a ng-if="policies.active && policies.listPolicies.active" ng-disabled="policies.listPolicies.loading" ng-click="policyModalChange();" class="btn btn-success pull-left" translate>返回授权</a>
  <button ng-if="info.edit" type="button" class="btn btn-primary" ng-click="updateGroup()" ng-disabled="user_group_modal.$pristine || user_group_modal.$invalid" translate>确定</button>
  <button type="button" class="btn btn-default" ng-click="cancel()" translate>取消</button>
</div>
