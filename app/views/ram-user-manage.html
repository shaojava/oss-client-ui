<div class="modal-body min-height-200">
  <form name="user_group_modal" novalidate="novalidate">
    <tabset>
      <button type="button" class="close" ng-click="cancel()">&times;</button>
      <tab heading="{{'用户信息'|translate}}" active="info.active" select="selectTabs('info');">
        <div ng-if="info.active" class="scrollbar" style="padding:10px;">
          <div ng-if="!info.edit">
            <div class="row">
              <div class="col-sm-3 text-right" translate>用户名：</div>
              <div class="col-sm-7">
                {{info.data.userName}}
              </div>
              <div class="col-sm-2">
                <a ng-click="changeEditModel();" translate>编辑</a>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>显示名：</div>
              <div class="col-sm-7">
                {{info.data.displayName}}
              </div>

            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>手机号：</div>
              <div class="col-sm-7">
                {{info.data.phone}}
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>邮箱：</div>
              <div class="col-sm-7">
                {{info.data.email}}
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>描述：</div>
              <div class="col-sm-7">
                {{info.data.desc}}
              </div>

            </div>
          </div>
          <div ng-if="info.edit">
            <div class="row">
              <div class="col-sm-3 text-right" translate>用户名：</div>
              <div class="col-sm-7">
                <input class="form-control" placeholder="{{'请输入用户名'|translate}}" ng-required="true" ng-pattern="info.pattern.name" ng-model="info.editData.userName">
              </div>
              <div class="col-sm-2">
                <a ng-click="changeEditModel();" translate>关闭编辑</a>
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>可包含大小写字母、数字、"."、"@"或中文且长度在1~64之间的字符</div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>显示名：</div>
              <div class="col-sm-7">
                <input class="form-control" placeholder="{{'请输入显示名'|translate}}" ng-pattern="info.pattern.display" ng-model="info.editData.displayName">
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>可包含大小写字母、数字、"."、"@"、"-"或中文且长度在0~12之间的字符</div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>手机号：</div>
              <div class="col-sm-7">
                <input class="form-control" placeholder="{{'请输入手机号'|translate}}" ng-pattern="info.pattern.phone" ng-model="info.editData.phone">
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>格式：国际区号-号码或11位手机号码，默认国际区号：86</div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>邮箱：</div>
              <div class="col-sm-7">
                <input class="form-control" placeholder="{{'请输入邮箱'|translate}}" ng-pattern="info.pattern.email" ng-model="info.editData.email">
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 text-right" translate>描述：</div>
              <div class="col-sm-7">
                <textarea rows="3" style="resize: none;" class="form-control" ng-pattern="info.pattern.desc" placeholder="{{'请输入描述信息'|translate}}" ng-model="info.editData.desc">
                </textarea>
              </div>
              <div class="col-sm-3"></div>
              <div class="col-sm-9 desc-test" translate>长度在0~128之间的任意字符</div>
            </div>
          </div>
        </div>
      </tab>
      <tab heading="{{'AccessKey管理'|translate}}" active="accessKey.active" select="selectTabs('accessKey');">
        <div ng-if="accessKey.active" class="scrollbar" style="padding:10px;max-height: 400px;overflow-y:auto;">
          <table class="table table-hover">
            <thead>
            <tr>
              <th width="50%">AccessKeyId</th>
              <th width="10%" translate>状态</th>
              <th width="15%" translate>创建时间</th>
              <th width="25%" translate>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-if="accessKey.loading">
              <td colspan="5">
                <div style="line-height: 30px;height: 30px;position: relative;">
                    <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                    </span>
                </div>
              </td>
            </tr>
            <tr ng-if="!accessKey.loading && +accessKey.list.length == 0">
              <td colspan="5" align="center">
                <span translate>暂无数据</span>
              </td>
            </tr>
            <tr ng-repeat="ak in accessKey.list">
              <td>
                <input readonly="readonly" class="form-control" type="text" ng-model="ak.AccessKeyId" style="width: 180px;display: inline-block;">
                <a class="btn btn-link" ng-click="showAkSecret(ak);" ng-disabled="ak.Status == 'Inactive'">Secret</a>
                <div ng-show="ak.showSecret" class="secret-container">
                   <input readonly="readonly" class="form-control" type="text" ng-model="ak.AccessKeySecret" style="color:orange;width: 350px;display: inline-block;">
                   <button type="button" class="close" ng-click="ak.showSecret = false;" style="margin-top:4px;">&times;</button>
                </div>
              </td>
              <td style="vertical-align: middle;">{{ak.Status == 'Active' ? ('启用'|translate) : ('禁用'|translate)}}</td>
              <td>{{ak.CreateDate|formatTime}}</td>
              <td>
                <a ng-if="ak.Status == 'Inactive'" class="btn btn-link" ng-click="updateAccessKey(ak);" translate>启用</a>
                <a ng-if="ak.Status == 'Active'" class="btn btn-link" ng-click="updateAccessKey(ak);" translate>禁用</a>
                <a class="btn btn-link" ng-click="delAccessKey(ak);" translate>删除</a>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </tab>
      <tab heading="{{'加入的组管理'|translate}}" active="group.active" select="selectTabs('group');">
        <div ng-if="group.active">
          <carousel class="news-carousel">
            <slide active="group.hasGroup.active">
              <div class="scrollbar" style="padding:10px;height:300px;overflow-y:auto;">
              <table class="table table-hover">
                <thead>
                <tr>
                  <th width="30%" translate>组名称</th>
                  <th width="30%" translate>描述</th>
                  <th width="25%" translate>加入时间</th>
                  <th width="15%" translate>操作</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-if="group.hasGroup.loading">
                  <td colspan="4" height="60px">
                    <div style="position:absolute;width:30px;margin:15px auto;left:50%;">
                      <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"  spinner-key="ram-user-manage-group"  spinner-start-active="1"></span>
                    </div>
                  </td>
                </tr>
                <tr ng-if="!group.hasGroup.loading && !group.hasGroup.list.length">
                  <td colspan="4" align="center" translate>暂无数据</td>
                </tr>
                <tr ng-repeat="group in group.hasGroup.list">
                  <td align="left">{{group.GroupName}}</td>
                  <td align="left">{{group.Comments}}</td>
                  <td align="left">{{group.JoinDate|formatTime}}</td>
                  <td align="left">
                    <a ng-click="removeUserToGroups(group,$index)" translate>退出</a>
                  </td>
                </tr>
                </tbody>
              </table>
                </div>
            </slide>
            <slide active="group.listGroup.active">
              <div class="scrollbar"scroll-load="loadMoreGroups()"
                   disable-scroll="group.listGroup.loading || !group.listGroup.hasMore" style="padding:10px;height:300px;overflow-y:auto;">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th width="30%" translate>组名称</th>
                      <th width="30%" translate>描述</th>
                      <th width="25%" translate>创建时间</th>
                      <th width="15%" translate>策略</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr ng-if="group.listGroup.loading">
                      <td colspan="5">
                        <div style="line-height: 30px;height: 30px;position: relative;">
                          <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                          </span>
                        </div>
                      </td>
                    </tr>
                  <tr ng-if="!group.listGroup.loading && +group.listGroup.list.length == 0">
                    <td colspan="5" align="center" translate>
                      没有数据
                    </td>
                  </tr>
                  <tr ng-repeat="group in group.listGroup.list">
                    <td align="left">{{group.GroupName}}</td>
                    <td align="left">{{group.Comments}}</td>
                    <td align="left">{{group.CreateDate|formatTime}}</td>
                    <td align="left">
                      <a ng-if="!group.exist" ng-click="addUserToGroup(group);" translate>加入</a>
                      <span ng-if="group.exist" class="text-success" translate>已加入</span>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </slide>
          </carousel>
        </div>
      </tab>
      <tab heading="{{'授权策略'|translate}}" active="policies.active" select="selectTabs('policy');">
        <div ng-if="policies.active">
          <carousel class="news-carousel">
            <slide active="policies.hasPolicies.active">
              <div class="scrollbar" style="padding:10px;height:300px;overflow-y:auto;">
                <table class="table table-hover">
                  <thead>
                  <tr>
                    <th width="18%" translate>策略名称</th>
                    <th width="16%" translate>策略类型</th>
                    <th width="16%" translate>默认版本</th>
                    <th width="20%" translate>描述</th>
                    <th width="20%" translate>授权时间</th>
                    <th width="10%" translate>操作</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="policies.hasPolicies.loading">
                    <td colspan="6">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                      <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                      </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!policies.hasPolicies.loading && +policies.hasPolicies.list.length == 0">
                    <td colspan="6" align="center">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="policy in policies.hasPolicies.list">
                    <td align="left">{{policy.PolicyName}}</td>
                    <td align="left">{{policy.PolicyType == 'Custom'?('自定义'|translate):('系统'|translate)}}</td>
                    <td align="left">{{policy.DefaultVersion}}</td>
                    <td align="left">{{policy.Description}}</td>
                    <td align="left">{{policy.AttachDate|formatTime}}</td>
                    <td>
                      <a ng-click="removePolicy(policy,$index)" translate>移除</a>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </slide>
            <slide active="policies.listPolicies.active">
              <div class="scrollbar"scroll-load="loadMorePolicies()"
                   disable-scroll="policies.listPolicies.loading || !policies.listPolicies.hasMore" style="padding:10px;height:300px;overflow-y:auto;">

                <table class="table table-hover">
                  <thead>
                  <tr>
                    <th width="20%" translate>策略名称</th>
                    <th width="30%" translate>描述</th>
                    <th width="18%" translate>引用次数</th>
                    <th width="18%">
                      <span dropdown>
                        <a data-toggle="dropdown" class="dropdown-toogle">
                          <span ng-show="policies.listPolicies.type == null" translate>全部类型</span>
                          <span ng-show="policies.listPolicies.type == 'Custom'" translate>自定义</span>
                          <span ng-show="policies.listPolicies.type == 'System'" translate>系统</span>
                          <span class="caret"></span>
                        </a>
                        <ul dropdown-menu class="dropdown-menu">
                          <li>
                            <a ng-click="changePolicyType(null)" translate>全部类型</a>
                          </li>
                          <li>
                            <a ng-click="changePolicyType('Custom')" translate>自定义</a>
                          </li>
                          <li>
                            <a ng-click="changePolicyType('System')" translate>系统</a>
                          </li>
                        </ul>
                      </span>
                    </th>
                    <th width="14%" translate>操作</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-if="policies.listPolicies.loading">
                    <td colspan="5">
                      <div style="line-height: 30px;height: 30px;position: relative;">
                      <span us-spinner="{lines:8,radius:10, length: 0,radius:6}"   spinner-start-active="1">
                      </span>
                      </div>
                    </td>
                  </tr>
                  <tr ng-if="!policies.listPolicies.loading && +policies.listPolicies.list.length == 0">
                    <td colspan="5" align="center">
                      <span translate>没有数据</span>
                    </td>
                  </tr>
                  <tr ng-repeat="policy in policies.listPolicies.list">
                    <td align="left">{{policy.PolicyName}}</td>
                    <td align="left">{{policy.Description}}</td>
                    <td align="left">{{policy.AttachmentCount}}</td>
                    <td align="left">{{policy.PolicyType == 'Custom'?('自定义'|translate):('系统'|translate)}}</td>
                    <td align="left">
                      <a ng-if="!policy.exist" ng-click="setPolicy(policy)" translate>授权</a>
                      <span ng-if="policy.exist" class="text-success" translate>已授权</span>
                    </td>
                  </tr>
                  </tbody>
                </table>

              </div>
            </slide>
          </carousel>
        </div>
      </tab>

    </tabset>
  </form>
</div>
<div class="modal-footer">
  <button ng-if="info.active" ng-click="deleteUser();" class="btn btn-danger pull-left" translate>删除用户</button>
  <button ng-if="accessKey.active" ng-click="createKey();" class="btn btn-success pull-left" translate>创建AccessKey</button>
  <a ng-if="group.active && group.hasGroup.active" ng-disabled="group.hasGroup.loading" ng-click="groupModalChange();" class="btn btn-success pull-left" translate>加入用户组</a>
  <a ng-if="group.active && group.listGroup.active" ng-disabled="group.listGroup.loading" ng-click="groupModalChange();" class="btn btn-success pull-left" translate>返回用户组</a>
  <a ng-if="policies.active && policies.hasPolicies.active" ng-disabled="policies.hasPolicies.loading" ng-click="policyModalChange();" class="btn btn-success pull-left" translate>添加授权</a>
  <a ng-if="policies.active && policies.listPolicies.active" ng-disabled="policies.listPolicies.loading" ng-click="policyModalChange();" class="btn btn-success pull-left" translate>返回授权</a>
  <button ng-if="info.edit" type="button" class="btn btn-primary" ng-click="updateUser()" ng-disabled="user_group_modal.$pristine || user_group_modal.$invalid" translate>确定</button>
  <button type="button" class="btn btn-default" ng-click="cancel()" translate>取消</button>
</div>
